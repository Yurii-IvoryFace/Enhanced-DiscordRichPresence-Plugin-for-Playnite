<UserControl x:Class="DiscordRichPresencePlugin.DiscordRichPresenceSettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:enums="clr-namespace:DiscordRichPresencePlugin.Enums"
             mc:Ignorable="d">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16" Orientation="Vertical" VerticalAlignment="Top" >

            <!-- Загальні -->
            <StackPanel Margin="0,8,0,0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Discord App ID:" VerticalAlignment="Center" Width="130"/>
                    <TextBox x:Name="AppIdBox"
             Width="280"
             Text="{Binding DiscordAppId, UpdateSourceTrigger=PropertyChanged}"
             PreviewTextInput="AppIdBox_PreviewTextInput"
             DataObject.Pasting="AppIdBox_OnPaste"
             ToolTip="Digits only (17–19). The numeric Client ID from Discord Developer Portal." />
                    <Button Content="Reconnect" Margin="8,0,0,0" Click="Reconnect_Click"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="130,2,0,0">
                    <TextBlock Text="{Binding ActiveAppId, StringFormat=Active App ID: {0}}" VerticalAlignment="Center" Foreground="Gray"/>
                    <Button Content="Copy" Margin="8,0,0,0" Padding="6,0"
          Click="CopyActiveId_Click"/>
                </StackPanel>

                <TextBlock Margin="130,4,0,0" Foreground="Gray"
             Text="Tip: App ID must be 17–19 digits; click Reconnect to apply without saving."/>
            </StackPanel>
            <GroupBox Header="Загальні" Margin="0,0,0,12">
                <StackPanel Margin="10" Orientation="Vertical" >
                    <CheckBox Content="Enable Discord Rich Presence"
                              IsChecked="{Binding EnableRichPresence}" />
                    <CheckBox Content="Show Platform"
                              IsChecked="{Binding ShowPlatform}" />
                    <CheckBox Content="Show Source"
                              IsChecked="{Binding ShowSource}" />
                    <CheckBox Content="Show Genres"
                              IsChecked="{Binding ShowGenre}" />
                    <CheckBox Content="Show Total Playtime"
                              IsChecked="{Binding ShowPlaytime}" />
                    <CheckBox Content="Show session timer (Elapsed)"
                              IsChecked="{Binding ShowElapsedTime}" />
                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="Update interval (seconds):" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox Width="60" Text="{Binding UpdateInterval, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="Fallback Large Image Key:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox Width="180" Text="{Binding FallbackImageKey}" />
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="Custom template (fallback):" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox Width="380" Text="{Binding CustomStatus}" />
                    </StackPanel>

                    <Button Content="Open folder with mappings (mapping)"
                            Margin="0,8,0,0"
                            Click="ButtonOpenMappingsFolder_Click"/>
                    <Button Content="Open assets folder" Margin="0,8,0,0" Click="ButtonOpenAssets_Click"/>
                </StackPanel>
            </GroupBox>

            <!-- Шаблони -->
            <GroupBox Header="Status Templates" Margin="0,0,0,12">
                <StackPanel Margin="10" Orientation="Vertical">
                    <CheckBox Content="Use Templates"
                              IsChecked="{Binding UseTemplates}" />
                    <TextBlock Margin="0,6,0,0" TextWrapping="Wrap"
                               Opacity="0.8">
                        For fine tuning (enabling/disabling individual templates, priorities), use the manager:
                    </TextBlock>
                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <Button Content="Template Manager..." ToolTip="TemplateManagerView"
                                Padding="10,2"
                                Tag="templateManager" />
                        <TextBlock Text="  (10 built-in templates enabled by default)" VerticalAlignment="Center" />
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <!-- Прогрес -->
            <GroupBox Header="Progress" Margin="0,0,0,12">
                <StackPanel Margin="10" Orientation="Vertical">
                    <CheckBox Content="Show % completion"
                              IsChecked="{Binding ShowCompletionPercentage}" />
                    <CheckBox Content="Show achievements"
                              IsChecked="{Binding ShowAchievements}" />
                    <TextBlock Margin="0,6,0,0" TextWrapping="Wrap"
                               Opacity="0.8">
                        Ці поля заповнюються з ExtendedGameInfoService. Якщо дані відсутні — секції не відображаються.
                    </TextBlock>
                </StackPanel>
            </GroupBox>

            <!-- Кнопки -->
            <GroupBox Header="Discord buttons" Margin="0,0,0,12">
                <StackPanel Margin="10" Orientation="Vertical">
                    <CheckBox Content="Show buttons"
                              IsChecked="{Binding ShowButtons}" />

                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <TextBlock Text="Button mode:" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox Width="180"
                                  SelectedValue="{Binding ButtonMode}"
                                  SelectedValuePath="Tag">
                            <ComboBoxItem Tag="{x:Static enums:ButtonDisplayMode.Off}">Off</ComboBoxItem>
                            <ComboBoxItem Tag="{x:Static enums:ButtonDisplayMode.Auto}">Auto</ComboBoxItem>
                        </ComboBox>
                    </StackPanel>

                    <TextBlock Margin="0,6,0,0" TextWrapping="Wrap" Opacity="0.8">
                          In “Auto” mode, ButtonService selects up to 2 most relevant buttons (game links, store page, achievements, etc.).
                    </TextBlock>
                </StackPanel>
            </GroupBox>

            <!-- Довідка -->
            <GroupBox Header="Help" Margin="0,0,0,0">
                <StackPanel Margin="10" Orientation="Vertical">
                    <TextBlock TextWrapping="Wrap">
                         Tip: If Discord does not update your status, restart Playnite and the game. Check that EnableRichPresence is enabled.
                    </TextBlock>
                    <TextBlock Margin="0,6,0,0" TextWrapping="Wrap">
                        For custom LargeImageKey images, use the names listed in the mappings.json file in the plugin folder.
                    </TextBlock>
                    <TextBlock Margin="8,8,0,0">
                        <Hyperlink NavigateUri="https://discord.com/developers/applications" RequestNavigate="Hyperlink_RequestNavigate">
                            Discord Developer Portal
                        </Hyperlink>
                    </TextBlock>
                </StackPanel>
            </GroupBox>

        </StackPanel>
    </ScrollViewer>
</UserControl>
